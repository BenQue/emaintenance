# E-Maintenance Secrets Template for Gitea CI/CD
# ================================================
# This file defines the structure for secrets that should be configured
# in Gitea Actions secrets. DO NOT commit actual values to repository!
# 
# Configure these in Gitea UI: Settings → Actions → Secrets

# === DATABASE CONFIGURATION ===
DB_NAME=emaintenance
DB_USER=postgres
DB_PASSWORD=${GITEA_SECRET_DB_PASSWORD}  # Strong password, min 16 chars
DB_HOST=postgres
DB_PORT=5432
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# === SECURITY KEYS ===
JWT_SECRET=${GITEA_SECRET_JWT_SECRET}  # Random 64-char string
JWT_EXPIRES_IN=7d
JWT_REFRESH_SECRET=${GITEA_SECRET_JWT_REFRESH_SECRET}  # Different from JWT_SECRET
JWT_REFRESH_EXPIRES_IN=30d

# === REDIS CONFIGURATION ===
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=${GITEA_SECRET_REDIS_PASSWORD}  # Strong password
REDIS_URL=redis://default:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}
REDIS_TTL=3600

# === ADMIN CONFIGURATION ===
ADMIN_EMAIL=admin@emaintenance.com
ADMIN_PASSWORD=${GITEA_SECRET_ADMIN_PASSWORD}  # Strong password, min 12 chars
ADMIN_FIRST_NAME=System
ADMIN_LAST_NAME=Administrator

# === DEPLOYMENT CONFIGURATION ===
DEPLOY_HOST=${GITEA_SECRET_DEPLOY_HOST}  # Production server IP/hostname
DEPLOY_USER=${GITEA_SECRET_DEPLOY_USER}  # Deployment user (not root)
DEPLOY_PATH=/opt/emaintenance
DEPLOY_SSH_KEY=${GITEA_SECRET_DEPLOY_SSH_KEY}  # Base64 encoded SSH private key

# === DOCKER REGISTRY (if using private registry) ===
DOCKER_REGISTRY=${GITEA_SECRET_DOCKER_REGISTRY}  # e.g., registry.yourdomain.com
DOCKER_REGISTRY_USER=${GITEA_SECRET_DOCKER_REGISTRY_USER}
DOCKER_REGISTRY_TOKEN=${GITEA_SECRET_DOCKER_REGISTRY_TOKEN}
DOCKER_REGISTRY_NAMESPACE=emaintenance

# === WEBHOOK CONFIGURATION ===
WEBHOOK_SECRET=${GITEA_SECRET_WEBHOOK_SECRET}  # For validating webhook requests
WEBHOOK_PORT=9000
DEPLOY_WEBHOOK_URL=${GITEA_SECRET_DEPLOY_WEBHOOK_URL}  # Full webhook URL

# === NOTIFICATION CONFIGURATION ===
NOTIFICATION_WEBHOOK=${GITEA_SECRET_NOTIFICATION_WEBHOOK}  # Slack/Discord/etc webhook
NOTIFICATION_EMAIL=${GITEA_SECRET_NOTIFICATION_EMAIL}  # Email for alerts
SMTP_HOST=${GITEA_SECRET_SMTP_HOST}
SMTP_PORT=${GITEA_SECRET_SMTP_PORT}
SMTP_USER=${GITEA_SECRET_SMTP_USER}
SMTP_PASSWORD=${GITEA_SECRET_SMTP_PASSWORD}

# === APPLICATION CONFIGURATION ===
NODE_ENV=production
LOG_LEVEL=info
LOG_DIR=/var/log/emaintenance
CORS_ORIGIN=${GITEA_SECRET_CORS_ORIGIN}  # Allowed origins, comma-separated

# === SERVICE URLS (for internal communication) ===
USER_SERVICE_URL=http://user-service:3001
WORK_ORDER_SERVICE_URL=http://work-order-service:3002
ASSET_SERVICE_URL=http://asset-service:3003

# === PUBLIC URLS (for frontend) ===
NEXT_PUBLIC_API_URL=http://${DEPLOY_HOST}:3001
NEXT_PUBLIC_USER_SERVICE_URL=http://${DEPLOY_HOST}:3001
NEXT_PUBLIC_WORK_ORDER_SERVICE_URL=http://${DEPLOY_HOST}:3002
NEXT_PUBLIC_ASSET_SERVICE_URL=http://${DEPLOY_HOST}:3003

# === RATE LIMITING ===
RATE_LIMIT_WINDOW=15
RATE_LIMIT_MAX_REQUESTS=1000
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false
RATE_LIMIT_SKIP_FAILED_REQUESTS=false

# === SESSION CONFIGURATION ===
SESSION_TIMEOUT=3600000  # 1 hour in milliseconds
SESSION_EXTEND_ON_ACTIVITY=true
MAX_SESSIONS_PER_USER=5

# === PASSWORD POLICY ===
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true
PASSWORD_HISTORY_COUNT=5
PASSWORD_EXPIRY_DAYS=90

# === BACKUP CONFIGURATION ===
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_DIR=/opt/emaintenance/backups
BACKUP_ENCRYPTION_KEY=${GITEA_SECRET_BACKUP_ENCRYPTION_KEY}

# === MONITORING ===
METRICS_ENABLED=true
METRICS_PORT=9090
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=5000

# === SSL/TLS CONFIGURATION (if applicable) ===
SSL_ENABLED=${GITEA_SECRET_SSL_ENABLED}
SSL_CERT_PATH=${GITEA_SECRET_SSL_CERT_PATH}
SSL_KEY_PATH=${GITEA_SECRET_SSL_KEY_PATH}
SSL_CA_PATH=${GITEA_SECRET_SSL_CA_PATH}

# === FEATURE FLAGS ===
ENABLE_SWAGGER_DOCS=false
ENABLE_DEBUG_LOGGING=false
ENABLE_PERFORMANCE_MONITORING=true
ENABLE_ERROR_TRACKING=true

# === GITEA CI/CD SPECIFIC ===
CI_DEPLOY_BRANCH=main
CI_STAGING_BRANCH=develop
CI_AUTO_DEPLOY=true
CI_RUN_TESTS=true
CI_SECURITY_SCAN=true
CI_BUILD_CACHE=true

# === PROJECT METADATA ===
PROJECT_NAME=emaintenance
PROJECT_VERSION=${GITEA_BUILD_VERSION}
BUILD_NUMBER=${GITEA_BUILD_NUMBER}
BUILD_TIMESTAMP=${GITEA_BUILD_TIMESTAMP}
DEPLOYED_BY=${GITEA_ACTOR}
COMMIT_SHA=${GITEA_SHA}