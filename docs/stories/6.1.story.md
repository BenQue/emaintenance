# Story 6.1: UI基础组件升级与shadcn/ui集成

## Status

Approved

## Story

**As a** 前端开发人员,
**I want** 将现有的基础UI组件升级为标准的shadcn/ui组件，并应用BizLink品牌配色系统,
**so that** 系统能够拥有统一、现代化的界面设计和更好的代码维护性。

## Acceptance Criteria

1. 升级现有基础UI组件（button, card, input, label, badge）为shadcn/ui标准组件
2. 集成BizLink品牌配色系统到Tailwind CSS配置中
3. 添加新的shadcn/ui核心组件（dialog, form, table, alert, select）
4. 确保所有组件遵循统一的设计规范和品牌标识
5. 更新组件使用文档和类型定义
6. 所有现有测试保持通过，新组件包含基础测试
7. 保持现有功能完全兼容，不破坏现有业务逻辑

## Tasks / Subtasks

- [ ] 升级现有基础UI组件 (AC: 1, 4)
  - [ ] 使用shadcn/ui MCP服务获取button组件源码并集成
  - [ ] 使用shadcn/ui MCP服务获取card组件源码并集成
  - [ ] 使用shadcn/ui MCP服务获取input组件源码并集成
  - [ ] 使用shadcn/ui MCP服务获取label组件源码并集成
  - [ ] 使用shadcn/ui MCP服务获取badge组件源码并集成
  - [ ] 验证现有组件使用的向后兼容性

- [ ] 集成BizLink品牌配色系统 (AC: 2, 4)
  - [ ] 更新tailwind.config.ts配置文件，添加BizLink品牌色彩系统
  - [ ] 配置主品牌色（bizlink蓝色调）和系统功能色
  - [ ] 更新CSS变量定义支持品牌配色
  - [ ] 测试现有组件使用新配色系统的兼容性

- [ ] 添加新的shadcn/ui核心组件 (AC: 3, 4)
  - [ ] 使用shadcn/ui MCP服务获取dialog组件源码并集成
  - [ ] 使用shadcn/ui MCP服务获取form组件源码并集成
  - [ ] 使用shadcn/ui MCP服务获取table组件源码并集成
  - [ ] 使用shadcn/ui MCP服务获取alert组件源码并集成
  - [ ] 使用shadcn/ui MCP服务获取select组件源码并集成

- [ ] 建立组件文档和类型系统 (AC: 5)
  - [ ] 创建组件使用文档和示例
  - [ ] 更新TypeScript类型定义
  - [ ] 建立组件导入和使用的标准模式

- [ ] 测试和验证 (AC: 6, 7)
  - [ ] 验证所有现有UI组件测试仍然通过
  - [ ] 为新添加的shadcn/ui组件创建基础测试
  - [ ] 进行回归测试确保现有功能无破坏
  - [ ] 验证品牌配色在不同组件上的一致性

## Dev Notes

### Previous Story Insights

从Story 5.1（Asset Service Implementation Completion）完成的经验:

- 系统已具备完整的微服务架构和认证体系
- 现有UI组件库需要现代化和标准化
- 代码质量和维护性是重要考量因素
- 测试覆盖率和向后兼容性是关键要求

### 技术栈信息 [Source: docs/architecture/3-技术栈.md]

- **前端**: Next.js v14+ (Web) [Source: docs/architecture/3-技术栈.md]
- **语言**: TypeScript用于前端开发
- **UI框架**: 将集成shadcn/ui组件库
- **样式**: Tailwind CSS配合品牌配色系统

### 项目结构信息 [Source: docs/architecture/11-统一项目结构.md]

**当前前端UI组件结构**:

```text
apps/web/components/
├── ui/                           # 基础UI组件目录
│   ├── badge.tsx                 # 需要升级为shadcn/ui
│   ├── button.tsx                # 需要升级为shadcn/ui
│   ├── card.tsx                  # 需要升级为shadcn/ui
│   ├── input.tsx                 # 需要升级为shadcn/ui
│   ├── label.tsx                 # 需要升级为shadcn/ui
│   ├── AuthenticatedImage.tsx    # 保持现有功能
│   ├── BizLinkLogo.tsx          # 保持现有品牌组件
│   ├── QRCode.tsx               # 保持现有功能
│   └── QRCodeModal.tsx          # 后续升级为shadcn/ui dialog
```

**需要添加的新组件**:

```text
apps/web/components/ui/
├── dialog.tsx                   # 新增 - 替换现有模态框
├── form.tsx                     # 新增 - 统一表单处理
├── table.tsx                    # 新增 - 替换现有表格
├── alert.tsx                    # 新增 - 系统通知
└── select.tsx                   # 新增 - 下拉选择
```

### 编码标准 [Source: docs/architecture/16-编码标准.md]

- **Component Pattern**: React组件必须遵循已提供的模板 [Source: docs/architecture/16-编码标准.md]
- **State Management**: 状态应通过领域特定的Zustand stores进行管理 [Source: docs/architecture/16-编码标准.md]
- **Service Layer**: 所有API通信必须通过定义的服务层进行 [Source: docs/architecture/16-编码标准.md]

### BizLink品牌配色系统技术实现

**Tailwind CSS配置更新** (基于UI重设计规范):

```typescript
// tailwind.config.ts需要添加的配色配置
module.exports = {
  theme: {
    extend: {
      colors: {
        // BizLink 主品牌色彩
        bizlink: {
          50: '#E3F2FD', // 最浅蓝
          100: '#BBDEFB', // 浅蓝
          200: '#90CAF9', // 中浅蓝
          300: '#64B5F6', // 中蓝
          400: '#42A5F5', // 浅蓝色变体
          500: '#1E88E5', // BizLink 标准蓝色 (主色)
          600: '#1976D2', // 中深蓝
          700: '#1565C0', // 深蓝色变体
          800: '#0D47A1', // 最深蓝色
          900: '#0A3D62', // 极深蓝
        },
        // 系统功能色彩
        functional: {
          success: '#2E7D32', // 成功绿
          warning: '#F57C00', // 警告橙
          error: '#C62828', // 错误红
          info: '#0097A7', // 信息青
        },
        // 保持兼容性的 primary 别名
        primary: {
          50: '#E3F2FD',
          100: '#BBDEFB',
          500: '#1E88E5', // BizLink 蓝
          600: '#1976D2',
          700: '#1565C0',
          900: '#0D47A1',
        },
      },
    },
  },
};
```

### shadcn/ui组件集成策略

**使用MCP服务获取组件**:

- 利用可用的shadcn/ui MCP服务获取标准组件源码
- 确保获取的组件与项目TypeScript配置兼容
- 保持组件的原始API接口以确保向后兼容性

**组件标准化导入模式**:

```typescript
// 标准化的组件导入和使用模式
import { Button } from "@/components/ui/button"
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card"
import { Form, FormControl, FormField, FormItem, FormLabel } from "@/components/ui/form"

// 使用品牌配色
<Button className="bg-primary-500 hover:bg-primary-600">
  创建工单
</Button>
```

### 现有组件兼容性要求

**关键兼容性检查点**:

- 所有现有的props接口保持不变
- 现有的CSS类名和样式继续有效
- 现有的事件处理逻辑不受影响
- 现有的TypeScript类型定义保持兼容

**测试验证要求**:

- 现有UI组件测试必须继续通过
- 新组件需要基础的渲染和交互测试
- 品牌配色系统的一致性验证

### 技术约束

- 必须保持与现有Next.js 14+和React 18+的兼容性
- 不能破坏现有的Zustand状态管理
- 必须支持现有的TypeScript严格模式
- 新组件必须支持现有的测试框架（Jest + React Testing Library）

## Testing

**测试策略基于架构标准 [Source: docs/architecture/15-测试策略.md]:**

遵循测试金字塔模型: 单元测试 > 集成测试 > E2E测试 [Source: docs/architecture/15-测试策略.md]

### Story 6.1的特定测试要求

**单元测试要求**:

- 所有升级的UI组件必须通过现有测试
- 新添加的shadcn/ui组件需要基础渲染测试
- 品牌配色系统的CSS类生成测试
- 组件props和事件处理的单元测试

**集成测试要求**:

- 验证新组件在现有页面中的正确渲染
- 测试组件间的交互和状态传递
- 验证品牌配色在不同组件组合中的一致性

**回归测试要求**:

- 现有所有UI相关测试必须继续通过
- 确保现有业务功能不受UI组件升级影响
- 验证表单、按钮、卡片等关键交互元素正常工作

**测试文件位置**:

- 组件单元测试：与源文件同目录，使用`.test.tsx`扩展名
- 集成测试：`components/__tests__/`目录
- 测试数据和模拟：`components/__tests__/fixtures/`目录

**测试覆盖率要求**:

- 新增UI组件至少80%代码覆盖率
- 关键交互路径100%覆盖
- 所有品牌配色相关CSS类必须被测试

## Change Log

| Date       | Version | Description                            | Author             |
| ---------- | ------- | -------------------------------------- | ------------------ |
| 2025-08-16 | 1.0     | Initial story creation for UI redesign | Bob (Scrum Master) |
